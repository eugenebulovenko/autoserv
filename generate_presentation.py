from pptx import Presentation
from pptx.util import Inches, Pt
from pptx.enum.text import PP_ALIGN
from pptx.dml.color import RGBColor
import os

# Слайды: (заголовок, основной текст, пометка для картинки)
slides_content = [
    # 0
    ("Введение", "Дипломная работа посвящена разработке системы автоматизации автосервиса. Программа предназначена для упрощения работы клиентов и персонала, повышения качества обслуживания и эффективности управления сервисом.", "[Логотип проекта или общий вид главной страницы]"),
    # 1
    ("Актуальность и задачи", "Автоматизация автосервиса позволяет минимизировать человеческий фактор, ускорить обработку заявок, повысить прозрачность процессов и улучшить клиентский опыт. Основные задачи: запись на обслуживание, управление заказ-нарядами, контроль работы персонала.", "[Инфографика 'до и после', тематическая фотография автосервиса]"),
    # 2
    ("Технологический стек", "В проекте используются современные веб-технологии: React (фронтенд), TypeScript, Vite (сборка), Tailwind CSS, shadcn-ui (дизайн), Supabase (бэкенд, база данных), Radix UI, Tanstack React Query, другие библиотеки.", "[Логотипы технологий]"),
    # 3
    ("Архитектура решения", "Программа реализована как одностраничное приложение (SPA). Взаимодействие с сервером и хранение данных — через Supabase. Вся логика и интерфейс — на стороне клиента.", "[Схема: пользователь → SPA → Supabase]"),
    # 4
    ("Главный интерфейс пользователя", "Дашборд пользователя — основной инструмент для работы с сервисом. Здесь отображаются записи, история обслуживания, рекомендации и быстрый доступ к функциям.", "[Главный экран (дашборд) пользователя]"),
    # 5
    ("Запись на обслуживание", "Пользователь может быстро записаться на обслуживание, выбрав дату, время и услугу. Возможна отмена и изменение записи.", "[Форма записи на сервис]"),
    # 6
    ("Управление автомобилями", "В системе реализовано добавление, просмотр и редактирование автомобилей клиента. Все данные хранятся в профиле пользователя.", "[Список автомобилей пользователя]"),
    # 7
    ("История обслуживания", "Пользователь может просматривать историю заказ-нарядов, статусы выполненных и текущих работ, детали оказанных услуг.", "[История заказ-нарядов]"),
    # 8
    ("Рекомендации по сервису", "Система автоматически предлагает рекомендации по сервису на основе истории обслуживания и состояния автомобиля.", "[Блок с рекомендациями на дашборде]"),
    # 9
    ("Административная панель: обзор", "Для сотрудников и руководства реализована отдельная административная панель с расширенными правами и функциями.", "[Меню админ-панели]"),
    # 10
    ("Управление клиентами и механиками", "В админ-панели можно добавлять, редактировать и искать клиентов и механиков. Вся информация структурирована и доступна для быстрого поиска.", "[Разделы 'Клиенты' и 'Механики']"),
    # 11
    ("Управление услугами и заказ-нарядами", "Администратор может создавать и редактировать услуги, отслеживать статусы заказ-нарядов, контролировать выполнение работ.", "[Разделы 'Услуги' и 'Заказ-наряды']"),
    # 12
    ("Программы лояльности и отчеты", "Система поддерживает создание программ лояльности для клиентов и формирование подробных отчетов по работе сервиса.", "[Разделы 'Лояльность' и 'Отчеты']"),
    # 13
    ("Внутренний мессенджер", "Встроенный мессенджер позволяет сотрудникам и администраторам быстро обмениваться сообщениями и координировать работу.", "[Окно мессенджера]"),
    # 14
    ("Уведомления и тултипы", "Для повышения удобства реализованы всплывающие подсказки и уведомления о важных событиях.", "[Пример уведомления или тултипа]"),
    # 15
    ("Генерация и экспорт отчетов", "Возможность выгрузки отчетов в формате PDF для анализа и хранения данных.", "[Пример PDF-отчета или кнопка экспорта]"),
    # 16
    ("Безопасность и авторизация", "В системе реализовано разграничение прав доступа: клиенты, механики, администраторы. Авторизация и хранение данных через Supabase.", "[Схема авторизации или окно входа]"),
    # 17
    ("Адаптивность и современный дизайн", "Интерфейс адаптирован под любые устройства: ПК, планшеты, смартфоны. Используются современные UI-компоненты и дизайн-система.", "[Интерфейс на мобильном устройстве]"),
    # 18
    ("Преимущества решения", "Интуитивный интерфейс, высокая скорость работы, масштабируемость, гибкая административная панель, безопасность и надежность.", "[Инфографика или таблица преимуществ]"),
    # 19
    ("Заключение и перспективы", "Реализованная система автоматизации автосервиса — современное, эффективное и масштабируемое решение. Возможности для дальнейшего развития: интеграция с CRM, мобильное приложение, расширение аналитики.", "[Диаграмма развития или тематическая картинка]")
]

# Сопоставление слайдов и файлов скриншотов (индекс: имя файла)
slide_images = [
    "Главная страница 1.jpg",   # Введение
    "Главная страница 2.jpg",   # Актуальность и задачи
    "Главная страница 3.jpg",   # Технологический стек
    "Главная страница 4.jpg",   # Архитектура решения
    "Личный кабинет 1.jpg",     # Главный интерфейс пользователя
    "Запись на сервис 1.jpg",   # Запись на обслуживание
    "Личный кабинет 2 (добавление авто).jpg", # Управление автомобилями
    "Личный кабинет 4 (завершенный ремонт).jpg", # История обслуживания
    "Личный кабинет 3 (добавление авто).png", # Рекомендации по сервису
    "Панель управления Администратора 1.jpg", # Административная панель: обзор
    "Панель управления Администратора 6 клиенты.jpg", # Управление клиентами и механиками
    "Панель управления Администратора 8 создание и редактирование услуг.jpg", # Управление услугами и заказ-нарядами
    "Панель управления Администратора 9 отчёты.jpg", # Программы лояльности и отчеты
    "чат с администратором.jpg", # Внутренний мессенджер
    "Панель управления Администратора 10 новости.jpg", # Уведомления и тултипы
    "печать заказ наряда.jpg", # Генерация и экспорт отчетов
    "Вход.jpg", # Безопасность и авторизация
    "настройка профиля.jpg", # Адаптивность и современный дизайн
    "Панель управления Администратора 10 обращения.jpg", # Преимущества решения
    "Панель управления Администратора 11 чат.jpg", # Заключение и перспективы
]

SCREENSHOTS_DIR = "screenshots"

def make_slide(prs, title, text, image_note, image_path=None):
    slide_layout = prs.slide_layouts[1]  # Заголовок и содержимое
    slide = prs.slides.add_slide(slide_layout)
    title_placeholder = slide.shapes.title
    content_placeholder = slide.placeholders[1]
    title_placeholder.text = title
    tf = content_placeholder.text_frame
    tf.clear()
    p = tf.add_paragraph()
    p.text = text
    p.font.size = Pt(20)
    p.font.name = 'Arial'
    p.font.color.rgb = RGBColor(34, 34, 34)
    p.alignment = PP_ALIGN.LEFT
    # Добавим пометку для картинки
    p2 = tf.add_paragraph()
    p2.text = image_note
    p2.font.size = Pt(14)
    p2.font.italic = True
    p2.font.color.rgb = RGBColor(120, 120, 120)
    p2.alignment = PP_ALIGN.RIGHT
    # Вставка изображения, если путь указан и файл существует
    if image_path and os.path.isfile(image_path):
        # Вставим картинку справа от текста
        left = Inches(7.5)
        top = Inches(1.5)
        width = Inches(5.5)
        slide.shapes.add_picture(image_path, left, top, width=width)

prs = Presentation()
prs.slide_width = Inches(13.33)
prs.slide_height = Inches(7.5)

# Титульный слайд
slide_layout = prs.slide_layouts[0]
title_slide = prs.slides.add_slide(slide_layout)
title_slide.shapes.title.text = "Автоматизация автосервиса"
title_slide.placeholders[1].text = "Дипломная работа\nФИО, 2025, Город"

# Основные слайды
for idx, (title, text, image_note) in enumerate(slides_content):
    image_path = os.path.join(SCREENSHOTS_DIR, slide_images[idx]) if idx < len(slide_images) else None
    make_slide(prs, title, text, image_note, image_path)

prs.save("presentation_template.pptx")
